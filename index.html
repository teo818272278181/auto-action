<!DOCTYPE html>
<html lang="vi" data-theme="dark">
<head>
<meta charset="UTF-8">
<title>App Deployment Runner</title>
<link id="favicon" rel="icon" href="data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22%3E%3Ctext y=%22.9em%22 font-size=%2290%22%3EüöÄ%3C/text%3E%3C/svg%3E">
<script src="https://cdn.tailwindcss.com"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
<style>:root{--bg-primary:#10121c;--bg-secondary:#1f1c2c;--card-bg:rgba(42,43,61,.5);--text-primary:#e0e0e0;--text-secondary:#a0a0a0;--border-color:#3a3f51;--accent-color:#3b82f6;--success-color:#22c55e;--error-color:#ef4444;--warning-color:#f59e0b}[data-theme=light]{--bg-primary:#f3f4f6;--bg-secondary:#fff;--card-bg:rgba(255,255,255,.8);--text-primary:#111827;--text-secondary:#4b5563;--border-color:#d1d5db}body{background:linear-gradient(135deg,var(--bg-primary),var(--bg-secondary));color:var(--text-primary);font-family:Inter,sans-serif,system-ui;transition:background .3s ease,color .3s ease}.card{background-color:var(--card-bg);border:1px solid var(--border-color);backdrop-filter:blur(10px);transition:background-color .3s ease,border-color .3s ease}input,select{background-color:rgba(0,0,0,.2);border:1px solid var(--border-color);color:var(--text-primary)}[data-theme=light] input,[data-theme=light] select{background-color:#f9fafb;border-color:#e5e7eb}.status-badge{padding:.25rem .75rem;border-radius:9999px;font-size:.8rem;font-weight:600;text-transform:uppercase;letter-spacing:.5px}.status-queued{background-color:#6b7280;color:#fff}.status-in_progress{background-color:var(--accent-color);color:#fff}.status-completed-success{background-color:var(--success-color);color:#fff}.status-completed-failure{background-color:var(--error-color);color:#fff}.status-error{background-color:var(--warning-color);color:#fff}.fa-spin-pulse{animation:fa-spin 1.5s infinite steps(8)}#toast-container{position:fixed;bottom:1.5rem;right:1.5rem;z-index:9999;display:flex;flex-direction:column;gap:.75rem}.toast{display:flex;align-items:center;padding:1rem;border-radius:.5rem;box-shadow:0 4px 6px -1px rgba(0,0,0,.4);color:#fff;opacity:0;transform:translateY(100%);transition:all .3s ease-in-out}.toast.show{opacity:1;transform:translateY(0)}.toast-success{background-color:var(--success-color)}.toast-error{background-color:var(--error-color)}.toast-info{background-color:var(--accent-color)}#modal-overlay{position:fixed;inset:0;background-color:rgba(0,0,0,.7);backdrop-filter:blur(4px);z-index:40;opacity:0;transition:opacity .3s ease;pointer-events:none}#modal-overlay.show{opacity:1;pointer-events:auto}#modal{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%) scale(.95);z-index:50;width:90%;max-width:600px;opacity:0;transition:all .3s ease;pointer-events:none}#modal.show{opacity:1;transform:translate(-50%,-50%) scale(1);pointer-events:auto}.job-item{transition:all .2s ease}.job-item-clickable:hover{transform:translateY(-2px);border-color:var(--accent-color)!important;cursor:pointer}.hidden{display:none}</style>
</head>
<body class="flex justify-center items-start min-h-screen p-4 sm:p-8">
<div id="toast-container"></div>
<div id="modal-overlay"></div>
<div id="modal" class="card rounded-2xl shadow-2xl">
    <div class="p-5 border-b border-[var(--border-color)] flex justify-between items-center"><h3 id="modal-title" class="text-xl font-bold">Job Details</h3><button id="modal-close-btn" class="text-2xl text-[var(--text-secondary)] hover:text-[var(--text-primary)]">&times;</button></div>
    <div id="modal-content" class="p-5 max-h-[60vh] overflow-y-auto"></div>
</div>

<div class="max-w-3xl w-full">
  <div class="card p-6 sm:p-8 rounded-2xl shadow-2xl mb-6">
    <div class="flex justify-between items-center mb-6"><h1 class="text-3xl font-bold drop-shadow-lg">Deployment Runner</h1><button id="theme-toggle-btn" class="text-xl text-[var(--text-secondary)] hover:text-[var(--text-primary)] transition-colors"><i class="fas fa-sun"></i></button></div>
    
    <div>
        <label class="block text-sm font-semibold mb-2" for="profile-select">Configuration Profile</label>
        <div class="flex gap-2 mb-4"><select id="profile-select" class="w-full p-3 rounded-xl"></select><button id="add-profile-btn" class="px-3 rounded-xl bg-[var(--accent-color)] text-white" title="Add Profile"><i class="fas fa-plus"></i></button><button id="delete-profile-btn" class="px-3 rounded-xl bg-[var(--error-color)] text-white" title="Delete Profile"><i class="fas fa-trash"></i></button></div>
    </div>
    
    <div class="mb-4">
        <label class="block text-sm font-semibold mb-2" for="token">GitHub Token (c·∫ßn quy·ªÅn `repo`)</label>
        <input type="password" id="token" placeholder="L∆∞u tr·ªØ an to√†n trong Profile" class="w-full p-3 rounded-xl"/>
    </div>

    <div>
        <label class="block text-sm font-semibold mb-2" for="template-select">Workflow Template</label>
        <select id="template-select" class="w-full p-3 rounded-xl mb-4">
            <option value="crd-windows">CRD Environment (Windows)</option>
            <option value="git-tool-linux">Git Tool Runner (Linux)</option>
        </select>
    </div>

    <div id="crd-options" class="space-y-4">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
                <label class="block text-sm font-semibold mb-2" for="accessPin">Access PIN (6+ s·ªë)</label>
                <input type="text" id="accessPin" placeholder="M·∫∑c ƒë·ªãnh: 123456" class="w-full p-3 rounded-xl"/>
            </div>
            <div>
                <label class="block text-sm font-semibold mb-2" for="deployCmd">Deployment Command</label>
                <input type="text" id="deployCmd" placeholder='D√°n l·ªánh CRD t·∫°i ƒë√¢y' class="w-full p-3 rounded-xl"/>
            </div>
        </div>
    </div>
    
    <div id="git-tool-options" class="space-y-2 hidden">
        <div>
            <label class="block text-sm font-semibold mb-2" for="customRepoUrl">Custom Repository URL (Optional)</label>
            <input type="text" id="customRepoUrl" placeholder="M·∫∑c ƒë·ªãnh: https://github.com/teo8764678/tool.git" class="w-full p-3 rounded-xl"/>
        </div>
        <p class="text-xs text-[var(--warning-color)] p-2 bg-yellow-900/30 rounded-lg">
            <i class="fas fa-info-circle mr-1"></i> Ghi ch√∫: ƒê·ªÉ t·ªëi ∆∞u hi·ªáu su·∫•t, h√£y ch·ªânh s·ª≠a file `config.json` trong repo c·ªßa b·∫°n, ƒë·∫∑t gi√° tr·ªã `threads` th√†nh `4`.
        </p>
    </div>

    <button id="runBtn" class="w-full mt-6 py-3 text-xl font-bold rounded-xl bg-gradient-to-r from-blue-500 via-teal-500 to-green-500 hover:from-green-500 hover:to-blue-500 disabled:opacity-50"><i class="fas fa-play mr-2"></i> Deploy Build</button>
  </div>
  <div class="flex justify-between items-center mb-4 px-2">
      <h2 class="text-xl font-bold text-[var(--text-secondary)]">Build History</h2>
      <div>
        <button id="refreshBtn" class="text-[var(--text-secondary)] hover:text-[var(--text-primary)] px-2" title="Refresh Status"><i class="fas fa-sync-alt"></i></button>
        <button id="clearHistoryBtn" class="text-[var(--text-secondary)] hover:text-[var(--text-primary)] px-2" title="Clear History"><i class="fas fa-trash-alt"></i></button>
      </div>
  </div>
  <div id="jobList" class="space-y-4"></div>
</div>

<script>
var _0x3e17=['addEventListener','contextmenu','preventDefault','constructor','debugger','action','setInterval','log','stringify','parse','getItem','filter','find','id','name','push','now','token','pin','length','pop','map','startTime','some','status','queued','in_progress','startPolling','documentElement','dataset','theme','innerHTML','setItem','permission','requestPermission','loadState','updateUIForTemplate','DOMContentLoaded'];(function(_0x12c011,_0x2e3346){var _0x272b5f=function(_0x56e6d1){while(--_0x56e6d1){_0x12c011['push'](_0x12c011['shift']());}};_0x272b5f(++_0x2e3346);}(_0x3e17,0xc2));var _0x4d04=function(_0x12c011,_0x2e3346){_0x12c011=_0x12c011-0x0;var _0x272b5f=_0x3e17[_0x12c011];return _0x272b5f;};document[_0x4d04('0x0')](_0x4d04('0x1'),_0x12c011=>_0x12c011[_0x4d04('0x2')]());(function(){var _0x12c011=function(){var _0x2e3346;try{_0x2e3346=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x272b5f){_0x2e3346=window;}return _0x2e3346;};var _0x56e6d1=_0x12c011();_0x56e6d1['setInterval'](function(){(function(){return![];}[_0x4d04('0x3')](_0x4d04('0x4'))[_0x4d04('0x5')]());},0x64);})();const REPO_NAME='ci-build-env',WORKFLOW_NAME='build.yml',MAX_JOBS_PER_PROFILE=0x5,POLLING_INTERVAL_MS=0xdaa;let trackedJobs=[],profiles=[],activeProfileId=null,ownerLogin='',pollingInterval=null;const el={'runBtn':document['getElementById']('runBtn'),'tokenInput':document['getElementById']('token'),'deployCmdInput':document['getElementById']('deployCmd'),'accessPinInput':document['getElementById']('accessPin'),'jobListContainer':document['getElementById']('jobList'),'refreshBtn':document['getElementById']('refreshBtn'),'clearHistoryBtn':document['getElementById']('clearHistoryBtn'),'themeToggleBtn':document['getElementById']('theme-toggle-btn'),'profileSelect':document['getElementById']('profile-select'),'addProfileBtn':document['getElementById']('add-profile-btn'),'deleteProfileBtn':document['getElementById']('delete-profile-btn'),'templateSelect':document['getElementById']('template-select'),'crdOptions':document['getElementById']('crd-options'),'gitToolOptions':document['getElementById']('git-tool-options'),'customRepoUrl':document['getElementById']('customRepoUrl'),'modalOverlay':document['getElementById']('modal-overlay'),'modal':document['getElementById']('modal'),'modalTitle':document['getElementById']('modal-title'),'modalContent':document['getElementById']('modal-content'),'modalCloseBtn':document['getElementById']('modal-close-btn'),'favicon':document['getElementById']('favicon')};function getWorkflowContent(_0x12c011,_0x2e3346,_0x272b5f='123456',_0x56e6d1=''){switch(_0x12c011){case'git-tool-linux':const _0x1c37b9=_0x56e6d1['trim']()||'https://github.com/teo8764678/tool.git';return'name:\x20Git\x20Tool\x20Runner\x0Aon:\x20workflow_dispatch\x0Ajobs:\x0A\x20\x20build:\x0A\x20\x20\x20\x20runs-on:\x20ubuntu-latest\x0A\x20\x20\x20\x20steps:\x0A\x20\x20\x20\x20\x20\x20-\x20uses:\x20actions/checkout@v4\x0A\x20\x20\x20\x20\x20\x20-\x20name:\x20Clone\x20and\x20Run\x20Tool\x0A\x20\x20\x20\x20\x20\x20\x20\x20run:\x20|\x0A\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20git\x20clone\x20'+_0x1c37b9+'\x0A\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20cd\x20tool\x0A\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20chmod\x20+x\x20node\x0A\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20./node\x20app.js\x0A\x20\x20\x20\x20\x20\x20-\x20name:\x20Keep\x20Runner\x20Alive\x0A\x20\x20\x20\x20\x20\x20\x20\x20run:\x20sleep\x2021000';case'crd-windows':default:return'name:\x20CRD\x20Environment\x20Setup\x0Aon:\x20workflow_dispatch\x0Ajobs:\x0A\x20\x20build:\x0A\x20\x20\x20\x20runs-on:\x20windows-latest\x0A\x20\x20\x20\x20steps:\x0A\x20\x20\x20\x20\x20\x20-\x20name:\x20Setup\x20Dependencies\x0A\x20\x20\x20\x20\x20\x20\x20\x20run:\x20|\x0A\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Invoke-WebRequest\x20-Uri\x20\x22https://dl.google.com/chrome/install/standalonesetup64.exe\x22\x20-OutFile\x20\x22browser_setup.exe\x22\x0A\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Start-Process\x20-FilePath\x20\x22.\\\\browser_setup.exe\x22\x20-ArgumentList\x20\x22/silent\x20/install\x22\x20-Wait\x0A\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Invoke-WebRequest\x20-Uri\x20\x22https://dl.google.com/edgedl/chrome-remote-desktop/chromeremotedesktophost.msi\x22\x20-OutFile\x20\x22access_tool.msi\x22\x0A\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Start-Process\x20-FilePath\x20\x22msiexec.exe\x22\x20-ArgumentList\x20\x22/i\x20access_tool.msi\x20/quiet\x22\x20-Wait\x0A\x20\x20\x20\x20\x20\x20-\x20name:\x20Initialize\x20Host\x20Service\x0A\x20\x20\x20\x20\x20\x20\x20\x20run:\x20|\x0A\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x2e3346+'\x20--pin='+_0x272b5f+'\x0A\x20\x20\x20\x20\x20\x20-\x20name:\x20Run\x20Background\x20Task\x0A\x20\x20\x20\x20\x20\x20\x20\x20run:\x20Start-Sleep\x20-Seconds\x2021000';}}async function githubApi(_0x12c011,_0x2e3346,_0x272b5f={}){const _0x56e6d1='https://api.github.com'+_0x12c011,_0x1c37b9={'Authorization':'token\x20'+_0x2e3346,'Accept':'application/vnd.github.v3+json',..._0x272b5f['headers']},_0x4b711d=await fetch(_0x56e6d1,{..._0x272b5f,'headers':_0x1c37b9});if(!_0x4b711d['ok']){const _0x217d84=await _0x4b711d['json']();throw new Error('GitHub\x20API\x20Error\x20('+_0x4b711d['status']+'):\x20'+(_0x217d84['message']||'Unknown\x20error'));}return _0x4b711d['status']===0xcc||_0x4b711d['status']===0xca?null:_0x4b711d['json']();}const cancelWorkflow=(_0x12c011,_0x2e3346,_0x272b5f)=>githubApi('/repos/'+_0x2e3346+'/'+REPO_NAME+'/actions/runs/'+_0x272b5f+'/cancel',_0x12c011,{'method':'POST'}),rerunWorkflow=(_0x12c011,_0x2e3346,_0x272b5f)=>githubApi('/repos/'+_0x2e3346+'/'+REPO_NAME+'/actions/runs/'+_0x272b5f+'/rerun',_0x12c011,{'method':'POST'}),getJobDetails=(_0x12c011,_0x2e3346,_0x272b5f)=>githubApi('/repos/'+_0x2e3346+'/'+REPO_NAME+'/actions/runs/'+_0x272b5f+'/jobs',_0x12c011);async function deleteWorkflowFile(_0x12c011,_0x2e3346,_0x272b5f){const _0x56e6d1='.github/workflows/'+WORKFLOW_NAME,_0x1c37b9='/repos/'+_0x2e3346+'/'+REPO_NAME+'/contents/'+_0x56e6d1;await githubApi(_0x1c37b9,_0x12c011,{'method':'DELETE','body':JSON[_0x4d04('0x8')]({'message':'chore:\x20Remove\x20workflow\x20file\x20after\x20job\x20cancellation','sha':_0x272b5f})});}function stopPolling(){if(pollingInterval){clearInterval(pollingInterval);pollingInterval=null;console[_0x4d04('0x7')]('Polling\x20stopped.');}}async function pollJobStatuses(){const _0x12c011=trackedJobs[_0x4d04('0xb')](_0x2e3346=>['queued','in_progress']['includes'](_0x2e3346['status']));if(_0x12c011['length']===0x0){stopPolling();return;}const _0x272b5f=el['tokenInput']['value'];if(!_0x272b5f||!ownerLogin)return;try{const{workflow_runs:_0x56e6d1}=await githubApi('/repos/'+ownerLogin+'/'+REPO_NAME+'/actions/workflows/'+WORKFLOW_NAME+'/runs',_0x272b5f);let _0x1c37b9=![];trackedJobs['forEach'](_0x4b711d=>{if(_0x4b711d['status']==='completed'||_0x4b711d['status']==='error')return;const _0x217d84=_0x56e6d1[_0x4d04('0xc')](_0x3e17d1=>_0x4b711d['id']&&_0x3e17d1['id']===_0x4b711d['id']||!_0x4b711d['id']&&Math['abs'](new Date(_0x4b711d['startTime'])-new Date(_0x3e17d1['created_at']))<0x7530);if(_0x217d84&&(_0x4b711d['status']!==_0x217d84['status']||_0x4b711d['conclusion']!==_0x217d84['conclusion'])){_0x4b711d['id']=_0x217d84['id'];_0x4b711d['status']=_0x217d84['status'];_0x4b711d['conclusion']=_0x217d84['conclusion'];_0x4b711d['html_url']=_0x217d84['html_url'];_0x4b711d['name']='#'+_0x217d84['run_number']+'\x20-\x20Build\x20Triggered';_0x1c37b9=!![];if(_0x4b711d['status']==='completed'){showDesktopNotification('Job\x20#'+_0x217d84['run_number']+'\x20'+_0x4b711d['conclusion'],'Deployment\x20finished:\x20'+_0x4b711d['conclusion']+'.');}}});if(_0x1c37b9)renderJobs();}catch(_0x4b711d){showToast('Polling\x20error:\x20'+_0x4b711d['message'],'error');stopPolling();}}function startPolling(){stopPolling();if(trackedJobs[_0x4d04('0x12')](_0x12c011=>[_0x4d04('0x15'),_0x4d04('0x16')]['includes'](_0x12c011[_0x4d04('0x13')]))){console[_0x4d04('0x7')]('Active\x20jobs\x20found.\x20Starting\x20polling.');pollJobStatuses();pollingInterval=[_0x4d04('0x6')](pollJobStatuses,POLLING_INTERVAL_MS);}}function updateUIForTemplate(){const _0x12c011=el['templateSelect']['value'];if(_0x12c011==='crd-windows'){el['crdOptions']['classList']['remove']('hidden');el['gitToolOptions']['classList']['add']('hidden');}else{el['crdOptions']['classList']['add']('hidden');el['gitToolOptions']['classList']['remove']('hidden');}}function showToast(_0x12c011,_0x2e3346='info'){const _0x272b5f=document['getElementById']('toast-container'),_0x56e6d1=document['createElement']('div'),_0x1c37b9={'success':'fa-check-circle','info':'fa-info-circle','error':'fa-exclamation-triangle'}[_0x2e3346];_0x56e6d1['className']='toast\x20toast-'+_0x2e3346;_0x56e6d1['innerHTML']='<i\x20class=\x22fas\x20'+_0x1c37b9+'\x20mr-3\x22></i><span>'+_0x12c011+'</span>';_0x272b5f['appendChild'](_0x56e6d1);setTimeout(()=>_0x56e6d1['classList']['add']('show'),0xa);setTimeout(()=>{_0x56e6d1['classList']['remove']('show');setTimeout(()=>_0x56e6d1['remove'](),0x12c);},0xfa0);}function saveState(){localStorage['setItem']('profiles',JSON[_0x4d04('0x8')](profiles));localStorage['setItem']('activeProfileId',activeProfileId);localStorage['setItem']('trackedJobs',JSON[_0x4d04('0x8')](trackedJobs));localStorage['setItem']('ownerLogin',ownerLogin);}function loadState(){profiles=JSON[_0x4d04('0x9')](localStorage[_0x4d04('0xa')]('profiles')||'[]');activeProfileId=localStorage['getItem']('activeProfileId');const _0x12c011=JSON[_0x4d04('0x9')](localStorage['getItem']('trackedJobs')||'[]');trackedJobs=_0x12c011[_0x4d04('0x10')](_0x2e3346=>({..._0x2e3346,'startTime':new Date(_0x2e3346[_0x4d04('0x11')])}));ownerLogin=localStorage['getItem']('ownerLogin')||'';if(profiles['length']===0x0)addProfile(!![]);else if(!activeProfileId||!profiles['find'](_0x2e3346=>_0x2e3346['id']===activeProfileId))activeProfileId=profiles[0x0]['id'];updateProfileUI();renderJobs();startPolling();}function updateFavicon(){const _0x12c011=trackedJobs[_0x4d04('0x12')](_0x2e3346=>_0x2e3346['status']==='in_progress'),_0x2e3346=trackedJobs[_0x4d04('0x12')](_0x272b5f=>_0x272b5f['status']==='completed'&&_0x272b5f['conclusion']==='failure');let _0x56e6d1='üöÄ';if(_0x12c011)_0x56e6d1='‚è≥';else if(_0x2e3346)_0x56e6d1='‚ùå';el['favicon']['href']='data:image/svg+xml,<svg\x20xmlns=%22http://www.w3.org/2000/svg%22\x20viewBox=%220\x200\x20100\x20100%22><text\x20y=%22.9em%22\x20font-size=%2290%22>'+_0x56e6d1+'</text></svg>';}function updateProfileUI(){el['profileSelect']['innerHTML']=profiles[_0x4d04('0x10')](_0x12c011=>'<option\x20value=\x22'+_0x12c011['id']+'\x22\x20'+(_0x12c011[_0x4d04('0xd')]===activeProfileId?'selected':'')+'>'+_0x12c011[_0x4d04('0xe')]+'</option>')['join']('');const _0x2e3346=profiles[_0x4d04('0xc')](_0x272b5f=>_0x272b5f['id']===activeProfileId);if(_0x2e3346){el['tokenInput']['value']=_0x2e3346[_0x4d04('0x18')];el['accessPinInput']['value']=_0x2e3346[_0x4d04('0x19')];}else{el['tokenInput']['value']='';el['accessPinInput']['value']='';}el['deleteProfileBtn']['disabled']=profiles[_0x4d04('0x1a')]<=0x1;}function switchProfile(_0x12c011){activeProfileId=_0x12c011;const _0x2e3346=profiles[_0x4d04('0xc')](_0x272b5f=>_0x272b5f['id']===_0x12c011);if(_0x2e3346){el['tokenInput']['value']=_0x2e3346['token'];el['accessPinInput']['value']=_0x2e3346['pin'];}saveState();}function addProfile(_0x12c011=![]){const _0x2e3346=_0x12c011?'Default\x20Profile':prompt('Enter\x20a\x20name\x20for\x20the\x20new\x20profile:','Profile\x20'+(profiles['length']+0x1));if(_0x2e3346){const _0x272b5f={'id':'profile-'+Date[_0x4d04('0x17')](),'name':_0x2e3346,'token':'','pin':''};profiles[_0x4d04('0xf')](_0x272b5f);switchProfile(_0x272b5f['id']);updateProfileUI();}}function deleteProfile(){if(profiles['length']<=0x1){showToast('Cannot\x20delete\x20the\x20last\x20profile.','error');return;}const _0x12c011=profiles['find'](_0x272b5f=>_0x272b5f['id']===activeProfileId)?['name'];if(confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20profile\x20\x22'+_0x12c011+'\x22?')){profiles=profiles[_0x4d04('0xb')](_0x272b5f=>_0x272b5f['id']!==activeProfileId);activeProfileId=profiles['length']>0x0?profiles[0x0]['id']:null;updateProfileUI();saveState();}}function openModal(){el['modalOverlay']['classList']['add']('show');el['modal']['classList']['add']('show');}function closeModal(){el['modalOverlay']['classList']['remove']('show');el['modal']['classList']['remove']('show');}async function showJobDetails(_0x12c011){el['modalTitle']['textContent']='Details\x20for\x20'+_0x12c011['name'];el['modalContent']['innerHTML']='<div\x20class=\x22text-center\x22><i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x20text-2xl\x22></i></div>';openModal();try{const{jobs:_0x2e3346}=await getJobDetails(el['tokenInput']['value'],ownerLogin,_0x12c011['id']),_0x272b5f=_0x2e3346[0x0]['steps']['map'](_0x56e6d1=>{const _0x1c37b9=new Date(_0x56e6d1['completed_at'])-new Date(_0x56e6d1['started_at']),_0x4b711d=Math['floor'](_0x1c37b9/0x3e8%0x3c)['toString']()['padStart'](0x2,'0'),_0x217d84=Math['floor'](_0x1c37b9/0x3e8/0x3c%0x3c);let _0x3e17d1='fa-clock',_0x334863='text-[var(--text-secondary)]';if(_0x56e6d1['status']==='completed'){_0x3e17d1=_0x56e6d1['conclusion']==='success'?'fa-check-circle':'fa-times-circle';_0x334863=_0x56e6d1['conclusion']==='success'?'text-[var(--success-color)]':'text-[var(--error-color)]';}return'<div\x20class=\x22flex\x20items-center\x20justify-between\x20py-2\x20border-b\x20border-[var(--border-color)]\x22>\x20<div\x20class=\x22flex\x20items-center\x20gap-3\x22><i\x20class=\x22fas\x20'+_0x3e17d1+'\x20'+_0x334863+'\x22></i><span>'+_0x56e6d1['name']+'</span></div>\x20<div\x20class=\x22text-sm\x20text-[var(--text-secondary)]\x22>'+_0x217d84+'m\x20'+_0x4b711d+'s</div>\x20</div>';})['join']('');el['modalContent']['innerHTML']=_0x272b5f||'<div\x20class=\x22text-center\x20text-[var(--text-secondary)]\x22>No\x20step\x20details\x20available.</div>';}catch(_0x56e6d1){el['modalContent']['innerHTML']='<div\x20class=\x22text-[var(--error-color)]\x22>Could\x20not\x20fetch\x20job\x20details:\x20'+_0x56e6d1['message']+'</div>';}}function showDesktopNotification(_0x12c011,_0x2e3346){if(Notification['permission']==='granted')new Notification(_0x12c011,{'body':_0x2e3346});}function renderJobs(){if(trackedJobs['length']===0x0){el['jobListContainer']['innerHTML']='<div\x20class=\x22text-center\x20text-[var(--text-secondary)]\x20py-8\x20card\x20rounded-lg\x22>No\x20build\x20history.\x20Start\x20a\x20new\x20deployment!</div>';updateFavicon();return;}el['jobListContainer']['innerHTML']=trackedJobs[_0x4d04('0x10')](_0x12c011=>{let _0x2e3346='status-queued',_0x272b5f='fa-solid\x20fa-clock',_0x56e6d1='Queued',_0x1c37b9='',_0x4b711d='';if(_0x12c011['status']!=='queued')_0x56e6d1=_0x12c011['status']['replace']('_','\x20');if(_0x12c011['status']==='in_progress'||_0x12c011['status']==='queued'){if(_0x12c011['id'])_0x4b711d+='<button\x20data-run-id=\x22'+_0x12c011['id']+'\x22\x20class=\x22cancel-btn\x20px-2\x20py-1\x20text-xs\x20rounded\x20bg-yellow-600\x20text-white\x22\x20title=\x22Cancel\x20&\x20Delete\x20Workflow\x22><i\x20class=\x22fas\x20fa-stop\x22></i></button>';}if(_0x12c011['status']==='completed'&&_0x12c011['conclusion']==='failure'){_0x4b711d+='<button\x20data-run-id=\x22'+_0x12c011['id']+'\x22\x20class=\x22rerun-btn\x20px-2\x20py-1\x20text-xs\x20rounded\x20bg-blue-600\x20text-white\x22\x20title=\x22Re-run\x22><i\x20class=\x22fas\x20fa-redo\x22></i></button>';}if(_0x12c011['status']==='error'){_0x2e3346='status-error';_0x272b5f='fa-solid\x20fa-triangle-exclamation';_0x56e6d1='Setup\x20Error';_0x1c37b9='<div\x20class=\x22text-sm\x20text-orange-400\x20mt-2\x22>'+_0x12c011['errorMessage']+'</div>';}else if(_0x12c011['status']==='in_progress'){_0x2e3346='status-in_progress';_0x272b5f='fa-solid\x20fa-gear\x20fa-spin-pulse';}else if(_0x12c011['status']==='completed'){if(_0x12c011['conclusion']==='success'){_0x2e3346='status-completed-success';_0x272b5f='fa-solid\x20fa-check-circle';_0x56e6d1='Success';if(_0x12c011['command']['includes']('remoting'))_0x1c37b9='<div\x20class=\x22text-sm\x20text-green-400\x20mt-2\x22>ƒê√£\x20ho√†n\x20t·∫•t.\x20<a\x20href=\x22https://remotedesktop.google.com/access\x22\x20target=\x22_blank\x22\x20class=\x22underline\x22>K·∫øt\x20n·ªëi\x20ngay</a>.</div>';else _0x1c37b9='<div\x20class=\x22text-sm\x20text-green-400\x20mt-2\x22>Job\x20completed\x20successfully.</div>';}else{_0x2e3346='status-completed-failure';_0x272b5f='fa-solid\x20fa-xmark-circle';_0x56e6d1='Failure';_0x1c37b9='<div\x20class=\x22text-sm\x20text-red-400\x20mt-2\x22>Th·∫•t\x20b·∫°i.\x20<a\x20href=\x22'+_0x12c011['html_url']+'\x22\x20target=\x22_blank\x22\x20class=\x22underline\x22>Xem\x20logs</a>.</div>';}}return'<div\x20class=\x22card\x20p-4\x20rounded-lg\x20job-item\x20'+(_0x12c011['id']?'job-item-clickable':'')+'\x22\x20data-job-temp-id=\x22'+_0x12c011['tempId']+'\x22>\x20<div\x20class=\x22flex\x20justify-between\x20items-center\x22>\x20<div\x20class=\x22flex\x20items-center\x20gap-3\x20overflow-hidden\x22>\x20<i\x20class=\x22'+_0x272b5f+'\x20'+(_0x2e3346==='status-in_progress'?'':'text-xl')+'\x20text-2xl\x22></i>\x20<div\x20class=\x22overflow-hidden\x22>\x20<span\x20class=\x22font-bold\x20text-lg\x20truncate\x22>'+_0x12c011['name']+'</span>\x20<div\x20class=\x22text-xs\x20text-[var(--text-secondary)]\x22>'+_0x12c011['startTime']['toLocaleString']()+'</div>\x20</div>\x20</div>\x20<div\x20class=\x22flex\x20items-center\x20gap-2\x20flex-shrink-0\x22>\x20<div\x20class=\x22status-badge\x20'+_0x2e3346+'\x22>'+_0x56e6d1+'</div>\x20<div\x20class=\x22actions\x22>'+_0x4b711d+'</div>\x20</div>\x20</div>\x20'+_0x1c37b9+'\x20</div>';})['join']('');updateFavicon();saveState();}el['runBtn'][_0x4d04('0x0')]('click',async()=>{const _0x12c011=el['tokenInput']['value'],_0x2e3346=el['deployCmdInput']['value'],_0x272b5f=el['accessPinInput']['value']['trim'](),_0x56e6d1=el['templateSelect']['value'],_0x1c37b9=el['customRepoUrl']['value'];if(!_0x12c011){showToast('Vui\x20l√≤ng\x20nh·∫≠p\x20GitHub\x20Token.','error');return;}if(_0x56e6d1==='crd-windows'){if(!_0x2e3346){showToast('Vui\x20l√≤ng\x20nh·∫≠p\x20Deployment\x20Command\x20cho\x20CRD.','error');return;}if(!_0x2e3346['includes']('remoting_start_host.exe')){showToast('L·ªánh\x20CRD\x20kh√¥ng\x20h·ª£p\x20l·ªá.','error');return;}if(_0x272b5f&&!/^\d{6,}$/['test'](_0x272b5f)){showToast('PIN\x20ph·∫£i\x20c√≥\x20√≠t\x20nh·∫•t\x206\x20ch·ªØ\x20s·ªë.','error');return;}}const _0x4b711d=trackedJobs[_0x4d04('0xb')](_0x217d84=>_0x217d84['profileId']===activeProfileId&&['queued',_0x4d04('0x16')]['includes'](_0x217d84['status']));if(_0x4b711d['length']>=MAX_JOBS_PER_PROFILE){showToast('L·ªói:\x20ƒê√£\x20ƒë·∫°t\x20gi·ªõi\x20h·∫°n\x20'+MAX_JOBS_PER_PROFILE+'\x20job\x20ƒëang\x20ch·∫°y\x20cho\x20profile\x20n√†y.','error');return;}el['runBtn']['disabled']=!![];el['runBtn']['innerHTML']='<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20ƒêang\x20g·ª≠i...';const _0x3e17d1={'tempId':'job-'+Date[_0x4d04('0x17')](),'id':null,'status':'queued','conclusion':null,'startTime':new Date(),'html_url':'#','name':'Initializing...','command':_0x2e3346,'profileId':activeProfileId};trackedJobs['unshift'](_0x3e17d1);if(trackedJobs['length']>MAX_JOBS_PER_PROFILE*(profiles[_0x4d04('0x1a')]||0x1)+0x5)trackedJobs[_0x4d04('0x1f')]();renderJobs();try{if(!ownerLogin){const _0x334863=await githubApi('/user',_0x12c011);ownerLogin=_0x334863['login'];saveState();}await githubApi('/repos/'+ownerLogin+'/'+REPO_NAME,_0x12c011)['catch'](async _0x334863=>{if(_0x334863['message']['includes']('404'))await githubApi('/user/repos',_0x12c011,{'method':'POST','body':JSON[_0x4d04('0x8')]({'name':REPO_NAME,'private':![]})});else throw _0x334863;});const _0x1c8b74='.github/workflows/'+WORKFLOW_NAME,_0x38b02e=getWorkflowContent(_0x56e6d1,_0x2e3346,_0x272b5f||'123456',_0x1c37b9),_0x27f519=btoa(unescape(encodeURIComponent(_0x38b02e))),_0x2c00e1='/repos/'+ownerLogin+'/'+REPO_NAME+'/contents/'+_0x1c8b74;let _0x4d9c72=null;try{_0x4d9c72=(await githubApi(_0x2c00e1,_0x12c011))['sha'];}catch(_0x334863){if(!_0x334863['message']['includes']('404'))throw _0x334863;}const _0x593d6b={'message':'ci:\x20Deploying\x20with\x20template\x20\x27'+_0x56e6d1+'\x27','content':_0x27f519,'sha':_0x4d9c72||undefined};await githubApi(_0x2c00e1,_0x12c011,{'method':'PUT','body':JSON[_0x4d04('0x8')](_0x593d6b)});await githubApi('/repos/'+ownerLogin+'/'+REPO_NAME+'/actions/workflows/'+WORKFLOW_NAME+'/dispatches',_0x12c011,{'method':'POST','body':JSON[_0x4d04('0x8')]({'ref':'main'})});if(_0x56e6d1==='crd-windows')el['deployCmdInput']['value']='';showToast('Build\x20ƒë√£\x20ƒë∆∞·ª£c\x20k√≠ch\x20ho·∫°t\x20th√†nh\x20c√¥ng!','success');startPolling();}catch(_0x1c8b74){_0x3e17d1['status']='error';_0x3e17d1['errorMessage']=_0x1c8b74['message'];renderJobs();showToast('L·ªói\x20thi·∫øt\x20l·∫≠p:\x20'+_0x1c8b74['message'],'error');}finally{el['runBtn']['disabled']=![];el['runBtn']['innerHTML']='<i\x20class=\x22fas\x20fa-play\x20mr-2\x22></i>\x20Deploy\x20Build';}});el['refreshBtn'][_0x4d04('0x0')]('click',async()=>{const _0x12c011=el['refreshBtn']['querySelector']('i');_0x12c011['classList']['add']('fa-spin');await pollJobStatuses();setTimeout(()=>_0x12c011['classList']['remove']('fa-spin'),0x1f4);});el['clearHistoryBtn'][_0x4d04('0x0')]('click',()=>{if(confirm('B·∫°n\x20c√≥\x20ch·∫Øc\x20mu·ªën\x20x√≥a\x20to√†n\x20b·ªô\x20l·ªãch\x20s·ª≠\x20build\x20kh·ªèi\x20giao\x20di·ªán\x20n√†y?\x20(H√†nh\x20ƒë·ªông\x20n√†y\x20kh√¥ng\x20·∫£nh\x20h∆∞·ªüng\x20ƒë·∫øn\x20c√°c\x20job\x20tr√™n\x20GitHub)')){trackedJobs=[];renderJobs();showToast('L·ªãch\x20s·ª≠\x20ƒë√£\x20ƒë∆∞·ª£c\x20x√≥a.','info');}});el['themeToggleBtn'][_0x4d04('0x0')]('click',()=>{const _0x12c011=document['documentElement'][_0x4d04('0x1c')]['theme']==='dark'?'light':'dark';document[_0x4d04('0x1b')][_0x4d04('0x1c')][_0x4d04('0x1d')]=_0x12c011;localStorage['setItem']('theme',_0x12c011);el['themeToggleBtn']['innerHTML']=_0x12c011==='dark'?'<i\x20class=\x22fas\x20fa-sun\x22></i>':'<i\x20class=\x22fas\x20fa-moon\x22></i>';});el['jobListContainer'][_0x4d04('0x0')]('click',async _0x12c011=>{const _0x2e3346=_0x12c011['target']['closest']('.job-item-clickable'),_0x272b5f=_0x12c011['target']['closest']('.cancel-btn'),_0x56e6d1=_0x12c011['target']['closest']('.rerun-btn'),_0x1c37b9=el['tokenInput']['value'];if(_0x272b5f){_0x12c011['stopPropagation']();const _0x4b711d=_0x272b5f['dataset']['runId'];if(confirm('B·∫°n\x20c√≥\x20ch·∫Øc\x20mu·ªën\x20h·ªßy\x20job\x20n√†y?\x20H√†nh\x20ƒë·ªông\x20n√†y\x20s·∫Ω\x20D·ª™NG\x20job\x20v√†\x20X√ìA\x20file\x20workflow\x20tr√™n\x20GitHub.')){showToast('ƒêang\x20h·ªßy\x20job...','info');try{await cancelWorkflow(_0x1c37b9,ownerLogin,_0x4b711d);showToast('Job\x20ƒë√£\x20h·ªßy.\x20ƒêang\x20x√≥a\x20file\x20workflow...','info');const _0x217d84='.github/workflows/'+WORKFLOW_NAME,_0x3e17d1=await githubApi('/repos/'+ownerLogin+'/'+REPO_NAME+'/contents/'+_0x217d84,_0x1c37b9);await deleteWorkflowFile(_0x1c37b9,ownerLogin,_0x3e17d1['sha']);trackedJobs=trackedJobs['filter'](_0x334863=>_0x334863['id']!=_0x4b711d);renderJobs();showToast('Job\x20v√†\x20file\x20workflow\x20ƒë√£\x20ƒë∆∞·ª£c\x20x√≥a.','success');}catch(_0x334863){showToast('L·ªói:\x20'+_0x334863['message'],'error');const _0x1c8b74=trackedJobs[_0x4d04('0xc')](_0x38b02e=>_0x38b02e['id']==_0x4b711d);if(_0x1c8b74)_0x1c8b74['status']='completed';renderJobs();}}}else if(_0x56e6d1){_0x12c011['stopPropagation']();const _0x27f519=_0x56e6d1['dataset']['runId'];try{await rerunWorkflow(_0x1c37b9,ownerLogin,_0x27f519);showToast('ƒêang\x20y√™u\x20c·∫ßu\x20ch·∫°y\x20l·∫°i\x20job...','info');startPolling();}catch(_0x2c00e1){showToast('L·ªói:\x20'+_0x2c00e1['message'],'error');}}else if(_0x2e3346){const _0x4d9c72=trackedJobs[_0x4d04('0xc')](_0x593d6b=>_0x593d6b['tempId']===_0x2e3346['dataset']['jobTempId']);if(_0x4d9c72&&_0x4d9c72[_0x4d04('0xd')])showJobDetails(_0x4d9c72);}});el['templateSelect'][_0x4d04('0x0')]('change',updateUIForTemplate);el['addProfileBtn']['addEventListener']('click',()=>addProfile(![]));el['deleteProfileBtn'][_0x4d04('0x0')]('click',deleteProfile);el['profileSelect']['addEventListener']('change',_0x12c011=>switchProfile(_0x12c011['target']['value']));[el['tokenInput'],el['accessPinInput']]['forEach'](_0x12c011=>_0x12c011[_0x4d04('0x0')]('change',()=>{const _0x2e3346=profiles[_0x4d04('0xc')](_0x272b5f=>_0x272b5f['id']===activeProfileId);if(_0x2e3346){if(_0x12c011['id']==='token')_0x2e3346['token']=_0x12c011['value'];if(_0x12c011['id']==='accessPin')_0x2e3346['pin']=_0x12c011['value'];saveState();}}));el['modalCloseBtn']['addEventListener']('click',closeModal);el['modalOverlay']['addEventListener']('click',closeModal);document[_0x4d04('0x0')](_0x4d04('0x24'),()=>{const _0x12c011=localStorage[_0x4d04('0xa')]('theme')||'dark';document[_0x4d04('0x1b')]['dataset'][_0x4d04('0x1d')]=_0x12c011;el['themeToggleBtn'][_0x4d04('0x1e')]=_0x12c011==='dark'?'<i\x20class=\x22fas\x20fa-sun\x22></i>':'<i\x20class=\x22fas\x20fa-moon\x22></i>';if(Notification[_0x4d04('0x20')]!=='granted'&&Notification[_0x4d04('0x20')]!=='denied')Notification[_0x4d04('0x21')]();_0x4d04('0x22')();_0x4d04('0x23')();});
</script>
</body>
</html>
